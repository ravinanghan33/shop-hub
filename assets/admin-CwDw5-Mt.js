import{j as e,C as U,S as N,a as $,B as h,u as Ie,A as Te,I as De,P as Ae,b as je,L as ue,T as i,G as b,d as A,e as Re,f as Oe,g as M,h as z,D as V,i as Q,k as Z,l as R,F as Le,m as We,n as Ee,M as Ue,o as $e,p as J,q as W,s as se,t as ae,v as ne,w as k,x as f,y as ie,z as oe,R as le,E as ye,H as fe,J as be,K as X,N as F,O as ve,Q as ce,U as ke,V as _e,W as ze,X as Ne,Y as Fe,Z as he,_ as Be,$ as qe,a0 as Me}from"./ui-vendor-Ci4yzqLt.js";import{a as y}from"./react-vendor-Ch971XjU.js";import{R as H,B as xe,C as ee,X as te,Y as re,T as G,L as ge,a as pe,P as He,b as Ge,c as Ke,d as Xe,e as Ve}from"./chart-vendor-BRAV1HZM.js";import{u as Qe}from"./query-vendor-4nEZiPK6.js";import{a as Ze}from"./utils-vendor-BupYmMrS.js";const Je=t=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(t),pt=(t,r)=>{try{const o=localStorage.getItem(t);return o?JSON.parse(o):r}catch(o){return console.error(`Error reading from localStorage: ${o}`),r}},mt=(t,r)=>{try{localStorage.setItem(t,JSON.stringify(r))}catch(o){console.error(`Error writing to localStorage: ${o}`)}};function B(t,r,o,n="Failed to fetch data. Please try again later."){const d=Qe({queryKey:t,queryFn:r,...o});return{data:d.data??null,loading:d.isLoading,error:d.error?n:null,refetch:()=>{d.refetch()},isLoading:d.isLoading}}const Ye="https://fakestoreapi.com",P=Ze.create({baseURL:Ye,timeout:1e4,headers:{"Content-Type":"application/json"}});P.interceptors.response.use(t=>t,t=>(console.error("API Error:",t),Promise.reject(t)));const _={getAll:async(t,r)=>{let o="/products";const n=new URLSearchParams;return t&&n.append("limit",t.toString()),r&&n.append("sort",r),n.toString()&&(o+=`?${n.toString()}`),(await P.get(o)).data},getById:async t=>(await P.get(`/products/${t}`)).data,getByCategory:async t=>(await P.get(`/products/category/${t}`)).data,create:async t=>(await P.post("/products",t)).data,update:async(t,r)=>(await P.put(`/products/${t}`,r)).data,partialUpdate:async(t,r)=>(await P.patch(`/products/${t}`,r)).data,delete:async t=>(await P.delete(`/products/${t}`)).data},et={getAll:async()=>(await P.get("/products/categories")).data},K={getAll:async(t,r)=>{let o="/users";const n=new URLSearchParams;return t&&n.append("limit",t.toString()),r&&n.append("sort",r),n.toString()&&(o+=`?${n.toString()}`),(await P.get(o)).data},getById:async t=>(await P.get(`/users/${t}`)).data,create:async t=>(await P.post("/users",t)).data,update:async(t,r)=>(await P.put(`/users/${t}`,r)).data,delete:async t=>(await P.delete(`/users/${t}`)).data},Ce={getAll:async(t,r,o,n)=>{let d="/carts";const a=new URLSearchParams;return t&&a.append("limit",t.toString()),r&&a.append("sort",r),o&&a.append("startdate",o),n&&a.append("enddate",n),a.toString()&&(d+=`?${a.toString()}`),(await P.get(d)).data},getById:async t=>(await P.get(`/carts/${t}`)).data,getUserCarts:async t=>(await P.get(`/carts/user/${t}`)).data,create:async t=>(await P.post("/carts",t)).data,update:async(t,r)=>(await P.put(`/carts/${t}`,r)).data,delete:async t=>(await P.delete(`/carts/${t}`)).data},de=(t,r)=>{const{data:o,loading:n,error:d,refetch:a,isLoading:g}=B(["products",t,r],()=>_.getAll(t,r),{},"Failed to fetch products. Please try again later.");return{products:o||[],loading:n,isLoading:g,error:d,refetch:a}},jt=t=>{const{data:r,loading:o,error:n,refetch:d,isLoading:a}=B(["product",t],()=>_.getById(t),{enabled:!!t},"Failed to fetch product. Please try again later.");return{product:r,products:r?[r]:[],loading:o,isLoading:a,error:n,refetch:d}},tt=()=>{const{data:t,loading:r,error:o,refetch:n,isLoading:d}=B(["categories"],()=>et.getAll(),{},"Failed to fetch categories. Please try again later.");return{categories:t||[],loading:r,isLoading:d,error:o,refetch:n}},yt=t=>{const{data:r,loading:o,error:n,refetch:d,isLoading:a}=B(["products","category",t],()=>t?_.getByCategory(t):_.getAll(),{},"Failed to fetch products. Please try again later.");return{products:r||[],loading:o,isLoading:a,error:n,refetch:d}},rt=()=>e.jsxs(U,{sx:{height:"100%",display:"flex",flexDirection:"column"},children:[e.jsx(N,{variant:"rectangular",height:240}),e.jsxs($,{sx:{flexGrow:1},children:[e.jsx(N,{variant:"text",height:60}),e.jsxs(h,{sx:{display:"flex",alignItems:"center",gap:1,my:1},children:[e.jsx(N,{variant:"rectangular",width:100,height:20}),e.jsx(N,{variant:"text",width:40})]}),e.jsx(N,{variant:"text",height:40,width:100,sx:{mb:1}}),e.jsx(N,{variant:"rectangular",height:36})]})]}),Pe=(t,r)=>{const{data:o,loading:n,error:d,refetch:a,isLoading:g}=B(["users",t,r],()=>K.getAll(t,r),{},"Failed to fetch users. Please try again later.");return{users:o||[],loading:n,isLoading:g,error:d,refetch:a}},Se=(t,r,o,n)=>{const{data:d,loading:a,error:g,refetch:j,isLoading:w}=B(["carts",t,r,o,n],()=>Ce.getAll(t,r,o,n),{},"Failed to fetch carts. Please try again later.");return{carts:d||[],loading:a,isLoading:w,error:g,refetch:j}},st=()=>{const t=Ie(),{products:r,loading:o}=de(),{users:n,loading:d}=Pe(),{carts:a,loading:g}=Se(),j=["#2563eb","#10b981","#f59e0b","#ef4444","#8b5cf6","#ec4899"],w=y.useMemo(()=>{const l=a.reduce((s,c)=>{const m=c.products.reduce((O,x)=>{const D=r.find(L=>L.id===x.productId);return O+(D?.price||0)*x.quantity},0);return s+m},0);return a.length>0&&l/a.length,[{title:"Total Revenue",value:`$${l.toFixed(2)}`,icon:e.jsx(Te,{sx:{fontSize:40}}),color:"#10b981",loading:g||o,change:"+12.5%"},{title:"Total Products",value:r.length,icon:e.jsx(De,{sx:{fontSize:40}}),color:"#2563eb",loading:o,change:"+3"},{title:"Total Users",value:n.length,icon:e.jsx(Ae,{sx:{fontSize:40}}),color:"#8b5cf6",loading:d,change:"+8"},{title:"Active Carts",value:a.length,icon:e.jsx(je,{sx:{fontSize:40}}),color:"#f59e0b",loading:g,change:"+5"}]},[r,n,a,o,d,g]),p=y.useMemo(()=>{const l={};return r.forEach(s=>{l[s.category]=(l[s.category]||0)+1}),Object.entries(l).map(([s,c])=>({name:s.charAt(0).toUpperCase()+s.slice(1),value:c}))},[r]),C=y.useMemo(()=>{const l=[{name:"$0-$50",min:0,max:50,count:0},{name:"$50-$100",min:50,max:100,count:0},{name:"$100-$200",min:100,max:200,count:0},{name:"$200-$500",min:200,max:500,count:0},{name:"$500+",min:500,max:1/0,count:0}];return r.forEach(s=>{const c=l.find(m=>s.price>=m.min&&s.price<m.max);c&&c.count++}),l},[r]),S=y.useMemo(()=>[...r].sort((l,s)=>s.rating.rate-l.rating.rate).slice(0,5).map(l=>({name:l.title.length>20?l.title.substring(0,20)+"...":l.title,rating:l.rating.rate,reviews:l.rating.count})),[r]),I=y.useMemo(()=>{const l={};return a.forEach(s=>{s.products.forEach(c=>{const m=r.find(O=>O.id===c.productId);if(m){const O=m.price*c.quantity;l[m.category]=(l[m.category]||0)+O}})}),Object.entries(l).map(([s,c])=>({name:s.charAt(0).toUpperCase()+s.slice(1),revenue:Math.round(c*100)/100}))},[r,a]);return o&&d&&g?e.jsx(h,{sx:{width:"100%",mt:2},children:e.jsx(ue,{})}):e.jsxs(h,{children:[e.jsxs(h,{sx:{mb:4},children:[e.jsx(i,{variant:"h4",fontWeight:700,gutterBottom:!0,children:"Dashboard Overview"}),e.jsx(i,{variant:"body1",color:"text.secondary",children:"Real-time insights and analytics for your e-commerce store"})]}),e.jsx(b,{container:!0,spacing:3,children:w.map((l,s)=>e.jsx(b,{item:!0,xs:12,sm:6,lg:3,children:e.jsx(U,{sx:{background:t.palette.mode==="dark"?`linear-gradient(135deg, ${A(l.color,.1)} 0%, ${A(l.color,.05)} 100%)`:`linear-gradient(135deg, ${A(l.color,.05)} 0%, ${A(l.color,.02)} 100%)`,border:`1px solid ${A(l.color,.1)}`},children:e.jsx($,{children:e.jsxs(h,{sx:{display:"flex",justifyContent:"space-between",alignItems:"flex-start"},children:[e.jsxs(h,{sx:{flex:1},children:[e.jsx(i,{color:"text.secondary",variant:"body2",gutterBottom:!0,fontWeight:500,children:l.title}),l.loading?e.jsx(h,{sx:{width:100,mt:2},children:e.jsx(ue,{sx:{borderRadius:2}})}):e.jsxs(e.Fragment,{children:[e.jsx(i,{variant:"h3",fontWeight:700,sx:{my:1},children:l.value}),e.jsx(i,{variant:"caption",sx:{color:"#10b981",fontWeight:600},children:l.change})]})]}),e.jsx(h,{sx:{width:64,height:64,borderRadius:2,display:"flex",alignItems:"center",justifyContent:"center",bgcolor:A(l.color,.1),color:l.color},children:l.icon})]})})})},s))}),e.jsxs(b,{container:!0,spacing:3,sx:{mt:1},children:[e.jsx(b,{item:!0,xs:12,lg:8,children:e.jsx(U,{children:e.jsxs($,{children:[e.jsxs(h,{sx:{display:"flex",alignItems:"center",gap:1,mb:3},children:[e.jsx(Re,{color:"primary"}),e.jsx(i,{variant:"h6",fontWeight:600,children:"Revenue by Category"})]}),I.length>0?e.jsx(H,{width:"100%",height:300,children:e.jsxs(xe,{data:I,children:[e.jsx(ee,{strokeDasharray:"3 3",stroke:A(t.palette.text.primary,.1)}),e.jsx(te,{dataKey:"name",stroke:t.palette.text.secondary}),e.jsx(re,{stroke:t.palette.text.secondary}),e.jsx(G,{contentStyle:{backgroundColor:t.palette.background.paper,border:`1px solid ${A(t.palette.text.primary,.1)}`,borderRadius:8}}),e.jsx(ge,{}),e.jsx(pe,{dataKey:"revenue",fill:"#2563eb",radius:[8,8,0,0]})]})}):e.jsx(i,{color:"text.secondary",align:"center",sx:{py:4},children:"No revenue data available"})]})})}),e.jsx(b,{item:!0,xs:12,lg:4,children:e.jsx(U,{children:e.jsxs($,{children:[e.jsxs(h,{sx:{display:"flex",alignItems:"center",gap:1,mb:3},children:[e.jsx(Oe,{color:"primary"}),e.jsx(i,{variant:"h6",fontWeight:600,children:"Product Categories"})]}),p.length>0?e.jsx(H,{width:"100%",height:300,children:e.jsxs(He,{children:[e.jsx(Ge,{data:p,cx:"50%",cy:"50%",labelLine:!1,label:({name:l,percent:s})=>`${l} ${(s*100).toFixed(0)}%`,outerRadius:80,fill:"#8884d8",dataKey:"value",children:p.map((l,s)=>e.jsx(Ke,{fill:j[s%j.length]},`cell-${s}`))}),e.jsx(G,{contentStyle:{backgroundColor:t.palette.background.paper,border:`1px solid ${A(t.palette.text.primary,.1)}`,borderRadius:8}})]})}):e.jsx(i,{color:"text.secondary",align:"center",sx:{py:4},children:"No category data available"})]})})})]}),e.jsxs(b,{container:!0,spacing:3,sx:{mt:1},children:[e.jsx(b,{item:!0,xs:12,lg:6,children:e.jsx(U,{children:e.jsxs($,{children:[e.jsx(i,{variant:"h6",fontWeight:600,gutterBottom:!0,children:"Price Distribution"}),e.jsx(i,{variant:"body2",color:"text.secondary",sx:{mb:3},children:"Products grouped by price range"}),C.some(l=>l.count>0)?e.jsx(H,{width:"100%",height:300,children:e.jsxs(xe,{data:C,children:[e.jsx(ee,{strokeDasharray:"3 3",stroke:A(t.palette.text.primary,.1)}),e.jsx(te,{dataKey:"name",stroke:t.palette.text.secondary}),e.jsx(re,{stroke:t.palette.text.secondary}),e.jsx(G,{contentStyle:{backgroundColor:t.palette.background.paper,border:`1px solid ${A(t.palette.text.primary,.1)}`,borderRadius:8}}),e.jsx(pe,{dataKey:"count",fill:"#10b981",radius:[8,8,0,0]})]})}):e.jsx(i,{color:"text.secondary",align:"center",sx:{py:4},children:"No price data available"})]})})}),e.jsx(b,{item:!0,xs:12,lg:6,children:e.jsx(U,{children:e.jsxs($,{children:[e.jsx(i,{variant:"h6",fontWeight:600,gutterBottom:!0,children:"Top Rated Products"}),e.jsx(i,{variant:"body2",color:"text.secondary",sx:{mb:3},children:"Best performing products by customer ratings"}),S.length>0?e.jsx(H,{width:"100%",height:300,children:e.jsxs(Xe,{data:S,children:[e.jsx(ee,{strokeDasharray:"3 3",stroke:A(t.palette.text.primary,.1)}),e.jsx(te,{dataKey:"name",stroke:t.palette.text.secondary}),e.jsx(re,{domain:[0,5],stroke:t.palette.text.secondary}),e.jsx(G,{contentStyle:{backgroundColor:t.palette.background.paper,border:`1px solid ${A(t.palette.text.primary,.1)}`,borderRadius:8}}),e.jsx(ge,{}),e.jsx(Ve,{type:"monotone",dataKey:"rating",stroke:"#f59e0b",strokeWidth:2,dot:{r:5}})]})}):e.jsx(i,{color:"text.secondary",align:"center",sx:{py:4},children:"No rating data available"})]})})})]}),e.jsxs(b,{container:!0,spacing:3,sx:{mt:1},children:[e.jsx(b,{item:!0,xs:12,md:6,children:e.jsx(U,{children:e.jsxs($,{children:[e.jsx(i,{variant:"h6",fontWeight:600,gutterBottom:!0,children:"Store Summary"}),e.jsxs(h,{sx:{mt:3,display:"flex",flexDirection:"column",gap:2},children:[e.jsxs(h,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsx(i,{variant:"body2",color:"text.secondary",children:"Total Products"}),e.jsx(i,{variant:"h6",fontWeight:600,children:r.length})]}),e.jsxs(h,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsx(i,{variant:"body2",color:"text.secondary",children:"Active Categories"}),e.jsx(i,{variant:"h6",fontWeight:600,children:p.length})]}),e.jsxs(h,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsx(i,{variant:"body2",color:"text.secondary",children:"Registered Users"}),e.jsx(i,{variant:"h6",fontWeight:600,children:n.length})]}),e.jsxs(h,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsx(i,{variant:"body2",color:"text.secondary",children:"Shopping Carts"}),e.jsx(i,{variant:"h6",fontWeight:600,children:a.length})]})]})]})})}),e.jsx(b,{item:!0,xs:12,md:6,children:e.jsx(U,{children:e.jsxs($,{children:[e.jsx(i,{variant:"h6",fontWeight:600,gutterBottom:!0,children:"Quick Insights"}),e.jsxs(h,{sx:{mt:3,display:"flex",flexDirection:"column",gap:2},children:[e.jsxs(M,{sx:{p:2,bgcolor:A("#10b981",.1),border:`1px solid ${A("#10b981",.2)}`},children:[e.jsx(i,{variant:"body2",fontWeight:600,color:"#10b981",children:"Average Product Rating"}),e.jsxs(i,{variant:"h5",fontWeight:700,sx:{mt:1},children:[r.length>0?(r.reduce((l,s)=>l+s.rating.rate,0)/r.length).toFixed(1):"0","⭐"]})]}),e.jsxs(M,{sx:{p:2,bgcolor:A("#2563eb",.1),border:`1px solid ${A("#2563eb",.2)}`},children:[e.jsx(i,{variant:"body2",fontWeight:600,color:"#2563eb",children:"Total Reviews"}),e.jsx(i,{variant:"h5",fontWeight:700,sx:{mt:1},children:r.reduce((l,s)=>l+s.rating.count,0)})]})]})]})})})]})]})},ft=Object.freeze(Object.defineProperty({__proto__:null,AdminDashboard:st},Symbol.toStringTag,{value:"Module"})),me=({text:t,maxLines:r=1,tooltipThreshold:o=50,maxWidth:n,...d})=>{const a=t.length>o,g=r===1?{overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",...n&&{maxWidth:n}}:{display:"-webkit-box",WebkitLineClamp:r,WebkitBoxOrient:"vertical",overflow:"hidden",...n&&{maxWidth:n}};return e.jsx(z,{title:t,disableHoverListener:!a,children:e.jsx(i,{...d,sx:{...g,...d.sx},children:t})})},at=({open:t,onClose:r,onSubmit:o,editingProduct:n,categories:d})=>{const[a,g]=y.useState({title:"",price:0,description:"",category:"",image:""}),[j,w]=y.useState({}),[p,C]=y.useState(!1);y.useEffect(()=>{g(n?{title:n.title,price:n.price,description:n.description,category:n.category,image:n.image}:{title:"",price:0,description:"",category:d[0]||"",image:""}),w({})},[n,d,t]);const S=()=>{const s={};return a.title.trim()?a.title.length<3&&(s.title="Title must be at least 3 characters"):s.title="Title is required",a.price<=0&&(s.price="Price must be greater than 0"),a.category||(s.category="Category is required"),a.description.trim()?a.description.length<10&&(s.description="Description must be at least 10 characters"):s.description="Description is required",a.image.trim()?I(a.image)||(s.image="Please enter a valid URL"):s.image="Image URL is required",w(s),Object.keys(s).length===0},I=s=>{try{return new URL(s),!0}catch{return!1}},l=async()=>{if(S())try{C(!0),await o(a),r()}catch(s){console.error("Form submission error:",s)}finally{C(!1)}};return e.jsxs(V,{open:t,onClose:r,maxWidth:"md",fullWidth:!0,children:[e.jsx(Q,{children:n?"Edit Product":"Add New Product"}),e.jsx(Z,{children:e.jsxs(h,{sx:{display:"flex",flexDirection:"column",gap:2,mt:2},children:[e.jsx(R,{label:"Product Title",fullWidth:!0,required:!0,value:a.title,onChange:s=>g({...a,title:s.target.value}),error:!!j.title,helperText:j.title,"aria-label":"Product title"}),e.jsx(R,{label:"Price",type:"number",fullWidth:!0,required:!0,value:a.price,onChange:s=>g({...a,price:parseFloat(s.target.value)||0}),inputProps:{min:0,step:.01},error:!!j.price,helperText:j.price,"aria-label":"Product price"}),e.jsxs(Le,{fullWidth:!0,required:!0,error:!!j.category,children:[e.jsx(We,{children:"Category"}),e.jsx(Ee,{value:a.category,label:"Category",onChange:s=>g({...a,category:s.target.value}),"aria-label":"Product category",children:d.map(s=>e.jsx(Ue,{value:s,sx:{textTransform:"capitalize"},children:s},s))}),j.category&&e.jsx($e,{children:j.category})]}),e.jsx(R,{label:"Description",fullWidth:!0,required:!0,multiline:!0,rows:4,value:a.description,onChange:s=>g({...a,description:s.target.value}),error:!!j.description,helperText:j.description,"aria-label":"Product description"}),e.jsx(R,{label:"Image URL",fullWidth:!0,required:!0,value:a.image,onChange:s=>g({...a,image:s.target.value}),placeholder:"https://example.com/image.jpg",error:!!j.image,helperText:j.image,"aria-label":"Product image URL"}),a.image&&I(a.image)&&e.jsx(h,{sx:{display:"flex",justifyContent:"center"},children:e.jsx(h,{component:"img",src:a.image,alt:"Product preview",sx:{width:150,height:150,objectFit:"contain",borderRadius:1,border:"1px solid",borderColor:"divider"}})})]})}),e.jsxs(J,{children:[e.jsx(W,{onClick:r,disabled:p,children:"Cancel"}),e.jsx(W,{variant:"contained",onClick:l,disabled:p,children:p?"Saving...":n?"Update":"Create"})]})]})},nt=({open:t,onClose:r,onConfirm:o,title:n="Confirm Delete",message:d="Are you sure you want to delete",itemName:a})=>{const g=()=>{o(),r()};return e.jsxs(V,{open:t,onClose:r,maxWidth:"sm",fullWidth:!0,children:[e.jsx(Q,{children:n}),e.jsx(Z,{children:e.jsxs(i,{children:[d," ",a&&e.jsx("strong",{children:a}),"? This action cannot be undone."]})}),e.jsxs(J,{children:[e.jsx(W,{onClick:r,color:"inherit",children:"Cancel"}),e.jsx(W,{onClick:g,color:"error",variant:"contained",children:"Delete"})]})]})};function it({columns:t,data:r,page:o,rowsPerPage:n,totalCount:d,onPageChange:a,onRowsPerPageChange:g,title:j,emptyMessage:w="No data available"}){return e.jsxs(h,{children:[j&&e.jsx(i,{variant:"h6",sx:{mb:2},children:j}),e.jsx(se,{component:M,children:e.jsxs(ae,{children:[e.jsx(ne,{children:e.jsx(k,{children:t.map(p=>e.jsx(f,{align:p.align,style:{minWidth:p.minWidth},children:p.label},String(p.id)))})}),e.jsx(ie,{children:r.length===0?e.jsx(k,{children:e.jsx(f,{colSpan:t.length,align:"center",sx:{py:4},children:e.jsx(i,{variant:"body2",color:"text.secondary",children:w})})}):r.map((p,C)=>e.jsx(k,{hover:!0,children:t.map(S=>{const I=p[S.id];return e.jsx(f,{align:S.align,children:S.format?S.format(I,p):String(I||"")},String(S.id))})},C))})]})}),e.jsx(oe,{rowsPerPageOptions:[5,10,25,50],component:"div",count:d,rowsPerPage:n,page:o,onPageChange:a,onRowsPerPageChange:g})]})}const E={PRODUCTS:{TITLE_TOOLTIP_THRESHOLD:50,DESCRIPTION_TOOLTIP_THRESHOLD:100,TITLE_MAX_WIDTH:300,IMAGE_SIZE:60,DESCRIPTION_MAX_LINES:2},PAGINATION:{DEFAULT_PAGE:0,DEFAULT_ROWS_PER_PAGE:10},SNACKBAR:{AUTO_HIDE_DURATION:4e3}},ot=()=>{const{products:t,loading:r,refetch:o}=de(),[n,d]=y.useState(E.PAGINATION.DEFAULT_PAGE),[a,g]=y.useState(E.PAGINATION.DEFAULT_ROWS_PER_PAGE),{categories:j}=tt(),[w,p]=y.useState(!1),[C,S]=y.useState(null),[I,l]=y.useState({open:!1,product:null}),[s,c]=y.useState({open:!1,message:"",severity:"success"}),m=()=>{S(null),p(!0)},O=v=>{S(v),p(!0)},x=()=>{p(!1),S(null)},D=async v=>{try{C?(await _.update(C.id,v),c({open:!0,message:"Product updated successfully!",severity:"success"})):(await _.create(v),c({open:!0,message:"Product created successfully!",severity:"success"})),o()}catch(T){throw console.error("Product operation error:",T),c({open:!0,message:"Operation failed. Please try again.",severity:"error"}),T}},L=v=>{l({open:!0,product:v})},q=()=>{l({open:!1,product:null})},u=async()=>{if(I.product)try{await _.delete(I.product.id),c({open:!0,message:"Product deleted successfully!",severity:"success"}),o()}catch(v){console.error("Product delete error:",v),c({open:!0,message:"Delete failed. Please try again.",severity:"error"})}};if(r)return e.jsxs(h,{children:[e.jsx(i,{variant:"h4",fontWeight:700,gutterBottom:!0,children:"Products Management"}),e.jsx(h,{sx:{display:"grid",gap:2,gridTemplateColumns:"repeat(auto-fill, minmax(300px, 1fr))"},children:Array.from(new Array(6)).map((v,T)=>e.jsx(rt,{},T))})]});const Y=[{id:"image",label:"Image",format:(v,T)=>e.jsx(h,{component:"img",src:v,alt:T.title,sx:{width:E.PRODUCTS.IMAGE_SIZE,height:E.PRODUCTS.IMAGE_SIZE,objectFit:"contain",borderRadius:1,border:"1px solid",borderColor:"divider",p:.5}})},{id:"title",label:"Product",format:(v,T)=>e.jsxs(h,{sx:{maxWidth:E.PRODUCTS.TITLE_MAX_WIDTH},children:[e.jsx(me,{text:v,maxLines:1,tooltipThreshold:E.PRODUCTS.TITLE_TOOLTIP_THRESHOLD,variant:"body2",fontWeight:600}),e.jsx(me,{text:T.description,maxLines:E.PRODUCTS.DESCRIPTION_MAX_LINES,tooltipThreshold:E.PRODUCTS.DESCRIPTION_TOOLTIP_THRESHOLD,variant:"caption",color:"text.secondary"})]})},{id:"category",label:"Category",format:v=>e.jsx(X,{label:v,size:"small",sx:{textTransform:"capitalize"}})},{id:"price",label:"Price",format:v=>e.jsx(i,{variant:"body2",fontWeight:600,children:Je(v)})},{id:"rating",label:"Rating",format:(v,T)=>e.jsxs(i,{variant:"body2",children:["⭐ ",T.rating.rate," (",T.rating.count,")"]})},{id:"actions",label:"Actions",align:"right",format:(v,T)=>e.jsxs(e.Fragment,{children:[e.jsx(z,{title:"Edit Product",children:e.jsx(F,{size:"small",color:"primary",onClick:()=>O(T),"aria-label":`Edit ${T.title}`,children:e.jsx(ve,{fontSize:"small"})})}),e.jsx(z,{title:"Delete Product",children:e.jsx(F,{size:"small",color:"error",onClick:()=>L(T),"aria-label":`Delete ${T.title}`,children:e.jsx(ce,{fontSize:"small"})})})]})}],we=t.slice(n*a,n*a+a);return e.jsxs(h,{children:[e.jsxs(h,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:3},children:[e.jsxs(h,{children:[e.jsx(i,{variant:"h4",fontWeight:700,gutterBottom:!0,children:"Products Management"}),e.jsxs(i,{variant:"body1",color:"text.secondary",children:[t.length," products in total"]})]}),e.jsxs(h,{sx:{display:"flex",gap:1},children:[e.jsx(W,{variant:"outlined",startIcon:e.jsx(le,{}),onClick:o,"aria-label":"Refresh products list",children:"Refresh"}),e.jsx(W,{variant:"contained",startIcon:e.jsx(ye,{}),onClick:m,"aria-label":"Add new product",children:"Add Product"})]})]}),e.jsx(it,{columns:Y,data:we,page:n,rowsPerPage:a,totalCount:t.length,onPageChange:(v,T)=>d(T),onRowsPerPageChange:v=>{g(parseInt(v.target.value,10)),d(0)},title:"Products",emptyMessage:"No products found"}),e.jsx(at,{open:w,onClose:x,onSubmit:D,editingProduct:C,categories:j}),e.jsx(nt,{open:I.open,onClose:q,onConfirm:u,itemName:I.product?.title}),e.jsx(fe,{open:s.open,autoHideDuration:E.SNACKBAR.AUTO_HIDE_DURATION,onClose:()=>c({...s,open:!1}),anchorOrigin:{vertical:"bottom",horizontal:"right"},children:e.jsx(be,{onClose:()=>c({...s,open:!1}),severity:s.severity,sx:{width:"100%"},children:s.message})})]})},bt=Object.freeze(Object.defineProperty({__proto__:null,AdminProducts:ot},Symbol.toStringTag,{value:"Module"})),lt=()=>{const{users:t,loading:r,refetch:o}=Pe(),[n,d]=y.useState(0),[a,g]=y.useState(10),[j,w]=y.useState(!1),[p,C]=y.useState(null),[S,I]=y.useState(!1),[l,s]=y.useState({open:!1,message:"",severity:"success"}),[c,m]=y.useState({email:"",username:"",password:"",name:{firstname:"",lastname:""},address:{city:"",street:"",number:0,zipcode:"",geolocation:{lat:"",long:""}},phone:""}),O=()=>{C(null),m({email:"",username:"",password:"",name:{firstname:"",lastname:""},address:{city:"",street:"",number:0,zipcode:"",geolocation:{lat:"",long:""}},phone:""}),w(!0)},x=u=>{C(u),m({email:u.email,username:u.username,password:u.password,name:u.name,address:u.address,phone:u.phone}),w(!0)},D=()=>{w(!1),C(null)},L=async()=>{try{I(!0),p?(await K.update(p.id,c),s({open:!0,message:"User updated successfully!",severity:"success"})):(await K.create(c),s({open:!0,message:"User created successfully!",severity:"success"})),D(),o()}catch{s({open:!0,message:"Operation failed. Please try again.",severity:"error"})}finally{I(!1)}},q=async u=>{if(window.confirm("Are you sure you want to delete this user?"))try{await K.delete(u),s({open:!0,message:"User deleted successfully!",severity:"success"}),o()}catch{s({open:!0,message:"Delete failed. Please try again.",severity:"error"})}};return r?e.jsx(i,{children:"Loading..."}):e.jsxs(h,{children:[e.jsxs(h,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:3},children:[e.jsxs(h,{children:[e.jsx(i,{variant:"h4",fontWeight:700,gutterBottom:!0,children:"Users Management"}),e.jsxs(i,{variant:"body1",color:"text.secondary",children:[t.length," registered users"]})]}),e.jsxs(h,{sx:{display:"flex",gap:1},children:[e.jsx(W,{variant:"outlined",startIcon:e.jsx(le,{}),onClick:o,children:"Refresh"}),e.jsx(W,{variant:"contained",startIcon:e.jsx(ye,{}),onClick:O,children:"Add User"})]})]}),e.jsxs(se,{component:M,children:[e.jsxs(ae,{children:[e.jsx(ne,{children:e.jsxs(k,{children:[e.jsx(f,{children:"User"}),e.jsx(f,{children:"Username"}),e.jsx(f,{children:"Contact"}),e.jsx(f,{children:"Location"}),e.jsx(f,{align:"right",children:"Actions"})]})}),e.jsx(ie,{children:t.slice(n*a,n*a+a).map(u=>e.jsxs(k,{hover:!0,children:[e.jsx(f,{children:e.jsxs(h,{sx:{display:"flex",alignItems:"center",gap:2},children:[e.jsxs(ke,{children:[u.name.firstname.charAt(0),u.name.lastname.charAt(0)]}),e.jsxs(h,{children:[e.jsxs(i,{variant:"body2",fontWeight:600,children:[u.name.firstname," ",u.name.lastname]}),e.jsxs(i,{variant:"caption",color:"text.secondary",children:["ID: ",u.id]})]})]})}),e.jsx(f,{children:e.jsx(X,{label:u.username,size:"small",variant:"outlined"})}),e.jsx(f,{children:e.jsxs(h,{sx:{display:"flex",flexDirection:"column",gap:.5},children:[e.jsxs(h,{sx:{display:"flex",alignItems:"center",gap:.5},children:[e.jsx(_e,{fontSize:"small",color:"action"}),e.jsx(i,{variant:"caption",children:u.email})]}),e.jsxs(h,{sx:{display:"flex",alignItems:"center",gap:.5},children:[e.jsx(ze,{fontSize:"small",color:"action"}),e.jsx(i,{variant:"caption",children:u.phone})]})]})}),e.jsx(f,{children:e.jsxs(h,{sx:{display:"flex",alignItems:"center",gap:.5},children:[e.jsx(Ne,{fontSize:"small",color:"action"}),e.jsxs(i,{variant:"caption",children:[u.address.city,", ",u.address.zipcode]})]})}),e.jsxs(f,{align:"right",children:[e.jsx(z,{title:"Edit User",children:e.jsx(F,{size:"small",color:"primary",onClick:()=>x(u),children:e.jsx(ve,{fontSize:"small"})})}),e.jsx(z,{title:"Delete User",children:e.jsx(F,{size:"small",color:"error",onClick:()=>q(u.id),children:e.jsx(ce,{fontSize:"small"})})})]})]},u.id))})]}),e.jsx(oe,{rowsPerPageOptions:[5,10,25,50],component:"div",count:t.length,rowsPerPage:a,page:n,onPageChange:(u,Y)=>d(Y),onRowsPerPageChange:u=>{g(parseInt(u.target.value,10)),d(0)}})]}),e.jsxs(V,{open:j,onClose:D,maxWidth:"md",fullWidth:!0,children:[e.jsx(Q,{children:p?"Edit User":"Add New User"}),e.jsx(Z,{children:e.jsxs(b,{container:!0,spacing:2,sx:{mt:1},children:[e.jsx(b,{item:!0,xs:12,sm:6,children:e.jsx(R,{label:"First Name",fullWidth:!0,required:!0,value:c.name.firstname,onChange:u=>m({...c,name:{...c.name,firstname:u.target.value}})})}),e.jsx(b,{item:!0,xs:12,sm:6,children:e.jsx(R,{label:"Last Name",fullWidth:!0,required:!0,value:c.name.lastname,onChange:u=>m({...c,name:{...c.name,lastname:u.target.value}})})}),e.jsx(b,{item:!0,xs:12,sm:6,children:e.jsx(R,{label:"Username",fullWidth:!0,required:!0,value:c.username,onChange:u=>m({...c,username:u.target.value})})}),e.jsx(b,{item:!0,xs:12,sm:6,children:e.jsx(R,{label:"Email",type:"email",fullWidth:!0,required:!0,value:c.email,onChange:u=>m({...c,email:u.target.value})})}),e.jsx(b,{item:!0,xs:12,sm:6,children:e.jsx(R,{label:"Password",type:"password",fullWidth:!0,required:!0,value:c.password,onChange:u=>m({...c,password:u.target.value})})}),e.jsx(b,{item:!0,xs:12,sm:6,children:e.jsx(R,{label:"Phone",fullWidth:!0,required:!0,value:c.phone,onChange:u=>m({...c,phone:u.target.value})})}),e.jsx(b,{item:!0,xs:12,children:e.jsx(i,{variant:"subtitle2",fontWeight:600,sx:{mb:1},children:"Address Information"})}),e.jsx(b,{item:!0,xs:12,sm:6,children:e.jsx(R,{label:"City",fullWidth:!0,required:!0,value:c.address.city,onChange:u=>m({...c,address:{...c.address,city:u.target.value}})})}),e.jsx(b,{item:!0,xs:12,sm:6,children:e.jsx(R,{label:"Street",fullWidth:!0,required:!0,value:c.address.street,onChange:u=>m({...c,address:{...c.address,street:u.target.value}})})}),e.jsx(b,{item:!0,xs:12,sm:6,children:e.jsx(R,{label:"Street Number",type:"number",fullWidth:!0,required:!0,value:c.address.number,onChange:u=>m({...c,address:{...c.address,number:parseInt(u.target.value)}})})}),e.jsx(b,{item:!0,xs:12,sm:6,children:e.jsx(R,{label:"Zipcode",fullWidth:!0,required:!0,value:c.address.zipcode,onChange:u=>m({...c,address:{...c.address,zipcode:u.target.value}})})})]})}),e.jsxs(J,{children:[e.jsx(W,{onClick:D,children:"Cancel"}),e.jsx(W,{variant:"contained",onClick:L,disabled:S||!c.username||!c.email,children:S?"Saving...":p?"Update":"Create"})]})]}),e.jsx(fe,{open:l.open,autoHideDuration:4e3,onClose:()=>s({...l,open:!1}),anchorOrigin:{vertical:"bottom",horizontal:"right"},children:e.jsx(be,{onClose:()=>s({...l,open:!1}),severity:l.severity,sx:{width:"100%"},children:l.message})})]})},vt=Object.freeze(Object.defineProperty({__proto__:null,AdminUsers:lt},Symbol.toStringTag,{value:"Module"})),ct=()=>{const{carts:t,loading:r,refetch:o}=Se(),{products:n}=de(),[d,a]=y.useState(null),[g,j]=y.useState(!1),[w,p]=y.useState(0),[C,S]=y.useState(10),I=x=>{a(x),j(!0)},l=()=>{j(!1),a(null)},s=async x=>{if(window.confirm("Are you sure you want to delete this cart?"))try{await Ce.delete(x),o()}catch(D){console.error("Delete failed:",D)}},c=x=>n.find(L=>L.id===x)?.title||`Product #${x}`,m=x=>n.find(L=>L.id===x)?.price||0,O=x=>x.products.reduce((D,L)=>{const q=m(L.productId);return D+q*L.quantity},0);return r?e.jsx(i,{children:"Loading..."}):e.jsxs(h,{children:[e.jsxs(h,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:3},children:[e.jsxs(h,{children:[e.jsx(i,{variant:"h4",fontWeight:700,gutterBottom:!0,children:"Carts & Orders Management"}),e.jsxs(i,{variant:"body1",color:"text.secondary",children:[t.length," active carts"]})]}),e.jsx(W,{variant:"outlined",startIcon:e.jsx(le,{}),onClick:o,children:"Refresh"})]}),e.jsxs(se,{component:M,children:[e.jsxs(ae,{children:[e.jsx(ne,{children:e.jsxs(k,{children:[e.jsx(f,{children:"Cart ID"}),e.jsx(f,{children:"User ID"}),e.jsx(f,{children:"Date"}),e.jsx(f,{children:"Items"}),e.jsx(f,{children:"Total Value"}),e.jsx(f,{align:"right",children:"Actions"})]})}),e.jsx(ie,{children:t.slice(w*C,w*C+C).map(x=>e.jsxs(k,{hover:!0,children:[e.jsx(f,{children:e.jsx(X,{icon:e.jsx(je,{}),label:`#${x.id}`,size:"small",color:"primary",variant:"outlined"})}),e.jsx(f,{children:e.jsxs(i,{variant:"body2",children:["User #",x.userId]})}),e.jsx(f,{children:e.jsx(i,{variant:"body2",children:new Date(x.date).toLocaleDateString()})}),e.jsx(f,{children:e.jsx(X,{label:`${x.products.length} items`,size:"small",color:"secondary"})}),e.jsx(f,{children:e.jsxs(i,{variant:"body2",fontWeight:600,children:["$",O(x).toFixed(2)]})}),e.jsxs(f,{align:"right",children:[e.jsx(z,{title:"View Cart Details",children:e.jsx(F,{size:"small",color:"primary",onClick:()=>I(x),children:e.jsx(Fe,{fontSize:"small"})})}),e.jsx(z,{title:"Delete Cart",children:e.jsx(F,{size:"small",color:"error",onClick:()=>s(x.id),children:e.jsx(ce,{fontSize:"small"})})})]})]},x.id))})]}),e.jsx(oe,{rowsPerPageOptions:[5,10,25,50],component:"div",count:t.length,rowsPerPage:C,page:w,onPageChange:(x,D)=>p(D),onRowsPerPageChange:x=>{S(parseInt(x.target.value,10)),p(0)}})]}),e.jsxs(V,{open:g,onClose:l,maxWidth:"sm",fullWidth:!0,children:[e.jsxs(Q,{children:["Cart Details - #",d?.id]}),e.jsx(Z,{children:d&&e.jsxs(h,{children:[e.jsxs(h,{sx:{mb:2},children:[e.jsxs(i,{variant:"body2",color:"text.secondary",children:["User ID: ",d.userId]}),e.jsxs(i,{variant:"body2",color:"text.secondary",children:["Date: ",new Date(d.date).toLocaleString()]})]}),e.jsx(he,{sx:{my:2}}),e.jsxs(i,{variant:"subtitle2",fontWeight:600,gutterBottom:!0,children:["Cart Items (",d.products.length,")"]}),e.jsx(Be,{children:d.products.map((x,D)=>e.jsx(qe,{sx:{border:1,borderColor:"divider",borderRadius:1,mb:1},children:e.jsx(Me,{primary:c(x.productId),secondary:e.jsxs(h,{children:[e.jsxs(i,{variant:"caption",color:"text.secondary",children:["Product ID: ",x.productId]}),e.jsx("br",{}),e.jsxs(i,{variant:"caption",color:"text.secondary",children:["Quantity: ",x.quantity," × $",m(x.productId).toFixed(2)," = $",(m(x.productId)*x.quantity).toFixed(2)]})]})})},D))}),e.jsx(he,{sx:{my:2}}),e.jsxs(h,{sx:{display:"flex",justifyContent:"space-between"},children:[e.jsx(i,{variant:"h6",fontWeight:600,children:"Total:"}),e.jsxs(i,{variant:"h6",fontWeight:600,color:"primary",children:["$",O(d).toFixed(2)]})]})]})}),e.jsx(J,{children:e.jsx(W,{onClick:l,children:"Close"})})]})]})},Ct=Object.freeze(Object.defineProperty({__proto__:null,AdminCarts:ct},Symbol.toStringTag,{value:"Module"}));export{ft as A,rt as P,jt as a,tt as b,yt as c,bt as d,vt as e,Je as f,pt as g,Ct as h,mt as s,de as u};
